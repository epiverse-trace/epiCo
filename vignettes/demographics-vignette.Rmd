---
title: "epiCo - Demographic module"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{epiCo Demographic Analyses}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  markdown: 
    wrap: 72
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

**epiCo**'s demographic module is a tool for demographic descriptive
analysis and risk assessment of epidemiological events in Colombia.
Based on linelist data provided by the Colombian National Surveillance System
[SIVIGILA](https://www.ins.gov.co/Direcciones/Vigilancia/Paginas/SIVIGILA.aspx)
and demographic data from the Colombian National Administrative Department of 
Statistics 
[DANE](https://microdatos.dane.gov.co/index.php/catalog/central/about).

The module allows you to:

-   Consult and visualize the population pyramid of a municipality,
    department, or the country for a year of interest
-   Consult the definitions of demographic variables as ethnicities,
    special populations groups, and occupational labels
-   Calculate and visualize a relative age risk by normalizing the
    distribution of cases by the specific age structure of the location
    of interest
-   Visualize the distribution of occupations reported in the linelist
    according to the [ISCO 88
    Standard](https://www.ilo.org/public/english/bureau/stat/isco/isco88/)

    
In the following vignette you will learn how to:

1. Navigate the Codification of the Political Administrative Division of Colombia (DIVIPOLA)
2. Consult, visualize and interpret Colombian population pyramids at different
population scales
3. Interpret the demographic variables reported by the SIVIGILA (as ethnicities,
special population groups, and occupatioanl labels)
4. Obtain official historic linelist data from SIVIGILA using
Epiverse-TRACE package [sivirep](https://github.com/epiverse-trace/sivirep)
5. Integrate age distributions of cases with population pyramids to obtain an age
risk assessment for a disease
6. Generate a treemap of reported occupations to estimate an exposure risk
assessment for a disease

## 1. Navigating the Codification of the Political Administrative Division of Colombia (DIVIPOLA)

DIVIPOLA is a standardized nomenclature, designed by the DANE, for the identification of territorial entities (departments, districts and municipalities), non-municipalized areas and populated centers, by assigning a unique numerical code to each of these territorial units.

Colombia has:

- 32 Departments (Administrative Division Level 1)
- 1102 Municipalities (Administrative Division Level 2)
- 1 Island
- 18 Non-municipalized areas
- 6678 Populated centers

Two digits are used for the codification of Departments, and five digits are used for the codification of municipalities (the first two being the the department where they are located).

**epiCo** provides the complete list of departments and municipalities codes through a built-in dataset.

```{r setup}
library(epiCo)
data("divipola_table")
```
## 2. Population pyramids

**epiCo** provides built-in dataset with the population projections of Colombia at national, department, and municipality level (provided by the DANE).

You can perform queries to these data by using the population_pyramid function, providing the DIVIPOLA code of the territory of interest and the year to consult.

```{r setup}
library(epiCo)
cali_code <- 76001 # DIVIPOLA code for the city of Cali
year <- 2016 # Year to consult
cali_pyramid_2016 <- population_pyramid(cali_code, year) # Population pyramid (dataframe) for the city of Cali in the year 2016 dissagregated by sex
```

Definition of age ranges, and plotting are also provided for both: total number of individuals or proportion of individuals

```{r setup}
library(epiCo)
cali_code <- 76001 # DIVIPOLA code for the city of Cali
year <- 2016 # Year to consult
age_range <- 5 # Age range or window
cali_pyramid_2016 <- population_pyramid(cali_code, year, range = age_range, total = FALSE, plot = TRUE)
```

## 3. Demographic varibles

Events of epidemiological relevance are reported to the SIVIGILA using an official notification form (see, [link](https://www.ins.gov.co/buscador-eventos/Paginas/Fichas-y-Protocolos.aspx)).

**epiCo** provides function to consult the dictionaries to the etnicity cathegories, special population groups, and occupation codification used by the SIVIGILA.

```{r setup}
library(epiCo)

demog_data = data.frame(id = c(0001,002,003,004,005),
ethnicity_label = c(3,4,1,2,5),
occupation_label = c(6111,3221,5113,5133))

describe_ethnicity(demog_data$ethnicity_label) # Description of ethnicities reported in the consulted dataset
describe_occupation(isco_codes = demog_data$occupation_labels, output_level = "unit") # Description of the occupations reported in the consulted dataset
```
